<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Documentation guidelines - Glean - Cross-platform Telemetry library</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../shared/glean.css">
        <link rel="stylesheet" href="../../shared/mermaid.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Developing the Glean SDK</a></li><li class="chapter-item expanded "><a href="../testing.html"><strong aria-hidden="true">1.</strong> Testing</a></li><li class="chapter-item expanded "><a href="../ci.html"><strong aria-hidden="true">2.</strong> Continuous Integration</a></li><li class="chapter-item expanded "><a href="../cut-a-new-release.html"><strong aria-hidden="true">3.</strong> Release process</a></li><li class="chapter-item expanded "><a href="../contributing.html"><strong aria-hidden="true">4.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../code_coverage.html"><strong aria-hidden="true">4.1.</strong> Code coverage</a></li></ol></li><li class="chapter-item expanded "><a href="../docs.html"><strong aria-hidden="true">5.</strong> Developing documentation</a></li><li class="chapter-item expanded "><a href="../upgrading-glean-parser.html"><strong aria-hidden="true">6.</strong> Upgrading glean_parser</a></li><li class="chapter-item expanded "><a href="../android/index.html"><strong aria-hidden="true">7.</strong> Android bindings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../android/setup-android-build-environment.html"><strong aria-hidden="true">7.1.</strong> Setup Build Environment</a></li><li class="chapter-item expanded "><a href="../android/sdk-ndk-versions.html"><strong aria-hidden="true">7.2.</strong> Android SDK/NDK versions</a></li><li class="chapter-item expanded "><a href="../android/logging.html"><strong aria-hidden="true">7.3.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../android/development-with-mozilla-central.html"><strong aria-hidden="true">7.4.</strong> Development with mozilla-central</a></li><li class="chapter-item expanded "><a href="../android/gradle-plugin-in-mc.html"><strong aria-hidden="true">7.5.</strong> Replacing the Glean Gradle plugin in mozilla-central</a></li><li class="chapter-item expanded "><a href="../android/glean-parser-substitution.html"><strong aria-hidden="true">7.6.</strong> Substituting glean_parser</a></li></ol></li><li class="chapter-item expanded "><a href="../ios/index.html"><strong aria-hidden="true">8.</strong> iOS bindings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ios/setup-ios-build-environment.html"><strong aria-hidden="true">8.1.</strong> Setup Build Environment</a></li><li class="chapter-item expanded "><a href="../ios/debug-glean-on-ios.html"><strong aria-hidden="true">8.2.</strong> Debugging different versions of Glean</a></li><li class="chapter-item expanded "><a href="../ios/upgrading-supported-ios-platform.html"><strong aria-hidden="true">8.3.</strong> Upgrading the supported Xcode version</a></li><li class="chapter-item expanded "><a href="../ios/glean-parser-substitution.html"><strong aria-hidden="true">8.4.</strong> Substituting glean_parser</a></li></ol></li><li class="chapter-item expanded "><a href="../python/index.html"><strong aria-hidden="true">9.</strong> Python bindings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../python/setting-up-python-build-environment.html"><strong aria-hidden="true">9.1.</strong> Setup Build Environment</a></li></ol></li><li class="chapter-item expanded "><a href="../core/index.html"><strong aria-hidden="true">10.</strong> Rust Component</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../core/documentation-guidelines.html" class="active"><strong aria-hidden="true">10.1.</strong> Documentation guidelines</a></li><li class="chapter-item expanded "><a href="../core/dependency-management.html"><strong aria-hidden="true">10.2.</strong> Dependency Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../core/dependency-vetting.html"><strong aria-hidden="true">10.2.1.</strong> Dependency Vetting</a></li></ol></li><li class="chapter-item expanded "><a href="../core/new-metric-type.html"><strong aria-hidden="true">10.3.</strong> Adding a new metric type</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../core/new-metric-type/kotlin.html"><strong aria-hidden="true">10.3.1.</strong> Kotlin</a></li><li class="chapter-item expanded "><a href="../core/new-metric-type/swift.html"><strong aria-hidden="true">10.3.2.</strong> Swift</a></li><li class="chapter-item expanded "><a href="../core/new-metric-type/python.html"><strong aria-hidden="true">10.3.3.</strong> Python</a></li><li class="chapter-item expanded "><a href="../core/new-metric-type/rust.html"><strong aria-hidden="true">10.3.4.</strong> Rust</a></li><li class="chapter-item expanded "><a href="../core/new-metric-type/platform.html"><strong aria-hidden="true">10.3.5.</strong> Platform</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../core/internal/index.html"><strong aria-hidden="true">11.</strong> Internal implementation details</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../core/internal/reserved-ping-names.html"><strong aria-hidden="true">11.1.</strong> Reserved ping names</a></li><li class="chapter-item expanded "><a href="../core/internal/clearing.html"><strong aria-hidden="true">11.2.</strong> Clearing metrics when disabling/enabling Glean</a></li><li class="chapter-item expanded "><a href="../core/internal/database.html"><strong aria-hidden="true">11.3.</strong> Database format</a></li><li class="chapter-item expanded "><a href="../core/internal/payload.html"><strong aria-hidden="true">11.4.</strong> Payload format</a></li><li class="chapter-item expanded "><a href="../core/internal/directory-structure.html"><strong aria-hidden="true">11.5.</strong> Directory & file structure</a></li><li class="chapter-item expanded "><a href="../core/internal/debug-pings.html"><strong aria-hidden="true">11.6.</strong> Debug Pings</a></li><li class="chapter-item expanded "><a href="../core/internal/upload.html"><strong aria-hidden="true">11.7.</strong> Upload mechanism</a></li><li class="chapter-item expanded "><a href="../core/internal/implementations.html"><strong aria-hidden="true">11.8.</strong> Implementations</a></li></ol></li><li class="chapter-item expanded "><a href="../api/index.html"><strong aria-hidden="true">12.</strong> API Documentation</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Glean - Cross-platform Telemetry library</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mozilla/glean" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/mozilla/glean/edit/main/docs/dev/./core/documentation-guidelines.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rust-documentation-guidelines"><a class="header" href="#rust-documentation-guidelines">Rust documentation guidelines</a></h1>
<p>The documentation for the Glean SDK Rust crates is automatically generated by the <a href="https://doc.rust-lang.org/rustdoc/what-is-rustdoc.html"><code>rustdoc</code></a> tool. That means the documentation for our Rust code is written as doc comments throughout the code.</p>
<p>Here we outline some guidelines to be followed when writing these doc comments.</p>
<h2 id="module-level-documentation"><a class="header" href="#module-level-documentation">Module level documentation</a></h2>
<p>Every module's index file must have a <a href="https://doc.rust-lang.org/book/ch14-02-publishing-to-crates-io.html#commenting-contained-items">module level doc comment</a>.</p>
<p>The module level documentation must start with a one-liner summary of the purpose of the module,
the rest of the text is free form and optional.</p>
<h2 id="function-and-constants-level-documentation"><a class="header" href="#function-and-constants-level-documentation">Function and constants level documentation</a></h2>
<p>Every public function / constant must have a dedicated <a href="https://doc.rust-lang.org/book/ch14-02-publishing-to-crates-io.html#making-useful-documentation-comments">doc comment</a>.</p>
<p>Non public functions / constants are not required to, but may have doc comments. These comments should follow
the same structure as public functions.</p>
<blockquote>
<p><strong>Note</strong> Private functions are not added to the generated documentation by default, but may be by using the <a href="https://doc.rust-lang.org/cargo/commands/cargo-doc.html"><code>--document-private-items</code></a> option.</p>
</blockquote>
<h3 id="structure"><a class="header" href="#structure">Structure</a></h3>
<p>Below is an example of the structure of a doc comment in one of the Glean SDK's public functions.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// Collects and submits a ping for eventual uploading.
///
/// The ping content is assembled as soon as possible, but upload is not
/// guaranteed to happen immediately, as that depends on the upload policies.
///
/// If the ping currently contains no content, it will not be sent,
/// unless it is configured to be sent if empty.
///
/// # Arguments
///
/// * `ping` - The ping to submit
/// * `reason` - A reason code to include in the ping
///
/// # Returns
///
/// Whether the ping was succesfully assembled and queued.
///
/// # Errors
///
/// If collecting or writing the ping to disk failed.
pub fn submit_ping(&amp;self, ping: &amp;PingType, reason: Option&lt;&amp;str&gt;) -&gt; Result&lt;bool&gt; {
    ...
}
<span class="boring">}</span></code></pre></pre>
<h4 id="every-doc-comment-must-start-with-a-one-liner-summary-of-what-that-function-is-about"><a class="header" href="#every-doc-comment-must-start-with-a-one-liner-summary-of-what-that-function-is-about">Every doc comment must start with a one-liner summary of what that function is about</a></h4>
<p>The text of this section should always be in the third person and describe an action.</p>
<p>If any additional information is necessary, that can be added following a new line after the summary.</p>
<h4 id="depending-on-the-signature-and-behavior-of-the-function-additional-sections-can-be-added-to-its-doc-comment"><a class="header" href="#depending-on-the-signature-and-behavior-of-the-function-additional-sections-can-be-added-to-its-doc-comment">Depending on the signature and behavior of the function, additional sections can be added to its doc comment</a></h4>
<p>These sections are:</p>
<ol>
<li><code># Arguments</code> - A list of the functions arguments and a short description of what they are. Note that there is no need to point out the type of the given argument on the doc comment since it is already outlined in the code.</li>
<li><code># Returns</code> - A short summary of what this function returns. Note that there is no need to start this summary with &quot;Returns...&quot; since that is already the title of the section.</li>
<li><code># Errors</code> - The possible paths that will or won't lead this function to return an error. It is at the discretion of the programmer to decide which cases are worth pointing out here.</li>
<li><code># Panics</code> - The possible paths that will or won't lead this function to <code>panic!</code>. It is at the discretion of the programmer to decide which cases are worth pointing out here.</li>
<li><code># Safety</code> - In case there are any safety concerns or guarantees, this is the section to point them out. It is at the discretion of the programmer to decide which cases are worth pointing out here.</li>
<li><code># Examples</code> - If necessary, this section holds examples of usage of the function.</li>
</ol>
<p>These sections should only be added to a doc comment when necessary, e.g. we only add an <code># Arguments</code> section when a function has arguments.</p>
<blockquote>
<p><strong>Note</strong> The titles of these sections must be level-1 headers. Additional sections not listed here can be level-2 or below.</p>
</blockquote>
<h3 id="link-to-all-the-things"><a class="header" href="#link-to-all-the-things">Link to all the things</a></h3>
<p>If the doc comment refers to some external structure, either from the Glean SDK's code base or external, make sure to link to it.</p>
<p>Example:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// Gets a [`PingType`] by name.
///
/// # Returns
///
/// The [`PingType`] of a ping if the given name was registered before, `None` otherwise.
///
/// [`PingType`]: metrics/struct.PingType.html
pub fn get_ping_by_name(&amp;self, ping_name: &amp;str) -&gt; Option&lt;&amp;PingType&gt; {
    ...
}
<span class="boring">}</span></code></pre></pre>
<blockquote>
<p><strong>Note</strong> To avoid polluting the text with multiple links, prefer using <a href="https://spec.commonmark.org/0.27/#reference-link">reference links</a> which allow for adding the actual links at the end of the text block.</p>
</blockquote>
<h3 id="warnings"><a class="header" href="#warnings">Warnings</a></h3>
<p>Important warnings about a function should be added, when necessary, before the one-liner summary in bold text.</p>
<p>Example:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// **Test-only API (exported for FFI purposes).**
///
/// Deletes all stored metrics.
///
/// Note that this also includes the ping sequence numbers, so it has
/// the effect of resetting those to their initial values.
pub fn test_clear_all_stores(&amp;self) {
    ...
}
<span class="boring">}</span></code></pre></pre>
<h3 id="semantic-line-breaks"><a class="header" href="#semantic-line-breaks">Semantic line breaks</a></h3>
<p>Prefer using <a href="https://sembr.org/">semantic line breaks</a> when breaking lines in any doc or non-doc comment.</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<p>These guidelines are largely based on the Rust API documentation guidelines.</p>
<ul>
<li><a href="https://github.com/rust-lang/rfcs/blob/master/text/1574-more-api-documentation-conventions.md">RFC 1574 - More API Documentation Conventions</a></li>
<li><a href="https://rust-lang.github.io/api-guidelines/documentation.html">Rust API Guidelines</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/mozilla/glean/edit/main/docs/dev/core/documentation-guidelines.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../core/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../core/dependency-management.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../core/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../core/dependency-management.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../shared/tabs.js"></script>
        <script src="../../shared/mermaid.min.js"></script>
        <script src="../../shared/mermaid-init.js"></script>


    </div>
    </body>
</html>
